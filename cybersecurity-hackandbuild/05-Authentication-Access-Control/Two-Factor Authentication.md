# Two-Factor Authentication

**Created:** 2025-11-25
**Tags:** #two-factor-authentication #2fa #authentication #access-control #security #mfa

## Description

Two-Factor Authentication (2FA) is a security process requiring users to provide two different authentication factors to verify their identity before gaining access. As a subset of [[Multi-Factor Authentication]], 2FA specifically requires exactly two factors, typically combining something the user knows (password) with something they have (mobile device) or are (biometric). The principle ensures that even if one factor is compromised, unauthorized access is still prevented.

The technology has become a baseline security requirement, with major platforms including Google, Microsoft, and banking institutions now offering or requiring 2FA. Microsoft reports that 2FA blocks 99.9% of automated attacks. While significantly improving security over password-only authentication, advanced attacks can still potentially compromise certain 2FA methods, particularly SMS-based codes vulnerable to SIM swapping and man-in-the-middle attacks.

Modern implementations balance security with usability through authenticator apps, push notifications, and hardware security keys. The widespread adoption has made 2FA familiar to users, though implementation quality varies. Organizations implementing 2FA typically see immediate security improvements while managing challenges like user adoption resistance and device management.

## Common 2FA Methods

**SMS Text Messages:** One-time codes sent via SMS. Easy to use but vulnerable to SIM swapping and interception. Works on any mobile phone without additional apps.

**Authenticator Apps (TOTP):** Time-based codes generated by apps like Google Authenticator or Microsoft Authenticator. More secure than SMS, works offline, follows RFC 6238 standard.

**Push Notifications:** Mobile app prompts for approval/denial. Very user-friendly with one-tap approval, can display context, but risks approval fatigue and requires internet connectivity.

**Hardware Security Keys:** Physical USB/NFC devices (YubiKey, Titan). Most secure phishing-resistant method using FIDO2/WebAuthn, fast and cryptographically secure, but requires purchasing hardware.

**Email Codes:** Verification codes via email. Accessible from any device but only as secure as the email account itself.

**Backup Codes:** Pre-generated one-time codes for emergency access when primary methods unavailable.

## Security Considerations

**Phishing Resistance Levels:**
- Most Resistant: Hardware security keys (FIDO2), certificate-based authentication
- Partially Resistant: Push notifications with context, TOTP apps
- Vulnerable: SMS codes, email codes

**Common Attacks:**
- SIM Swapping: Attacker transfers phone number to receive SMS codes
- Man-in-the-Middle: Real-time interception and relay of codes
- Social Engineering: Tricking users into providing codes
- 2FA Fatigue: Overwhelming users with requests until they approve
- Session Hijacking: Stealing session cookies after authentication

**Mitigations:** Use app-based 2FA over SMS, implement rate limiting, require additional verification for suspicious attempts, employ phishing-resistant methods for high-value accounts, educate users, implement short session timeouts.

## Best Practices

**For Users:** Enable 2FA everywhere possible, prefer authenticator apps over SMS, save backup codes securely, register multiple devices, never share codes, use security keys for critical accounts, review activity regularly.

**For Administrators:** Offer multiple 2FA options, start with privileged accounts, provide clear documentation, implement secure recovery with identity verification, monitor suspicious patterns, enforce for admin access, test thoroughly.

**For Developers:** Support multiple methods, follow standards (RFC 6238, FIDO2), implement rate limiting, provide clear errors, support backup codes, log 2FA events, timeout codes appropriately (5-10 minutes).

## Implementation Patterns

**Web Applications:** TOTP via QR codes, WebAuthn for hardware keys, remember device options, progressive enhancement.

**Mobile Apps:** Native biometric integration, push notifications, deep linking, secure enclave utilization.

**APIs:** OAuth 2.0 step-up authentication, API key + TOTP, service account handling, machine-to-machine considerations.

## Compliance Requirements

**PCI-DSS:** Requires 2FA for administrative access to cardholder data environment
**HIPAA:** Recommends 2FA for remote access to ePHI
**SOC 2:** 2FA for access management controls
**NIST 800-63B:** Guidelines for authenticator types and assurance levels
**GDPR:** 2FA as security measure for data protection

## Common Challenges

**User Resistance:** Demonstrate benefits, use risk-based authentication, offer convenient options, implement device trust.

**Lost Devices:** Provide backup codes, support multiple devices, implement secure recovery, offer temporary access via help desk.

**Travel/Connectivity:** Use offline TOTP apps, pre-download backup codes, enable multiple device enrollment, support WiFi-based push.

**Legacy Systems:** VPN/gateway-level 2FA, application proxy, modernization planning, compensating controls.

## Tools and Services

**Enterprise:** Microsoft Azure MFA, Duo Security, Okta, Ping Identity, Auth0, OneLogin

**Consumer:** Google 2-Step Verification, Apple Two-Factor, Facebook Login Approvals, Twitter 2FA

**Open Source:** FreeOTP, Aegis Authenticator, andOTP, Google Authenticator protocol

## Related Topics

- [[Multi-Factor Authentication]]
- [[Single Sign-On]]
- [[Kerberos]]
- [[RADIUS]]
- [[LDAP]]
- [[Certificate-Based Authentication]]
- [[Local Authentication]]
- [[Security+]]
- [[CISSP]]

## Further Learning

**Standards:** RFC 6238 (TOTP), RFC 4226 (HOTP), FIDO2/WebAuthn, NIST SP 800-63B

**Resources:** OWASP Authentication Cheat Sheet, Microsoft 2FA documentation, Google 2FA best practices, SANS implementation guides

---

**Back to:** [[00-MOC-Cybersecurity-Roadmap]]
